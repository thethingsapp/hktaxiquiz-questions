#!/usr/bin/env python3
"""
æ ¹æ“šå®˜æ–¹ PDF å…§å®¹ç”Ÿæˆ Part C å®Œæ•´é¡Œåº«
è‡ªå‹•ç‚ºæ¯å€‹å•é¡Œæ·»åŠ  2 å€‹éŒ¯èª¤é¸é …
"""

import json
import random
from typing import List, Dict

# å¾ PDF æå–çš„åœ°é»è³‡æ–™ï¼ˆç¤ºä¾‹ï¼‰
LOCATIONS = {
    # é†«é™¢
    "ç‘ªéº—é†«é™¢": "è–„æ‰¶æ—",
    "å¨çˆ¾æ–¯è¦ªç‹é†«é™¢": "æ²™ç”°",
    "è´Šè‚²é†«é™¢": "è¥¿ç‡Ÿç›¤",
    "æ±è¯é†«é™¢": "ä¸Šç’°",
    "æ±è¯ä¸‰é™¢é¦®å ¯æ•¬é†«é™¢": "è–„æ‰¶æ—",
    "è‘›é‡æ´ªé†«é™¢": "é»ƒç«¹å‘",
    "æ±å€å°¤å¾·å¤«äººé‚£æ‰“ç´ é†«é™¢": "æŸ´ç£",
    "æ±è¯æ±é™¢": "å¤§å‘",
    "é„§è‚‡å …é†«é™¢": "ç£ä»”",
    "å¾‹æ•¦æ²»é†«é™¢": "ç£ä»”",
    "é»ƒç«¹å‘é†«é™¢": "é»ƒç«¹å‘å¾‘",
    "ä¼Šåˆ©æ²™ä¼¯é†«é™¢": "æ²¹éº»åœ°",
    "ä¹é¾é†«é™¢": "ä¹é¾åŸ",
    "é¦™æ¸¯ä½›æ•™é†«é™¢": "æ¨‚å¯Œ",
    "é¦™æ¸¯çœ¼ç§‘é†«é™¢": "ä¹é¾åŸ",
    "æ±è¯ä¸‰é™¢é»ƒå¤§ä»™é†«é™¢": "æ²™ç”°å³é“",
    "è–æ¯é†«é™¢": "é»ƒå¤§ä»™",
    "å»£è¯é†«é™¢": "æ²¹éº»åœ°",
    "æ˜æ„›é†«é™¢": "é•·æ²™ç£",
    "ç‘ªå˜‰çƒˆé†«é™¢": "è”æ™¯",
    "è‘µæ¶Œé†«é™¢": "è”æ™¯",
    "ä»æ¿Ÿé†«é™¢": "èƒç£",
    "åŸºç£æ•™è¯åˆé†«é™¢": "ç§€èŒ‚åª",
    "éˆå¯¦é†«é™¢": "å°‡è»æ¾³",
    "å°‡è»æ¾³é†«é™¢": "å¯¶å¯§é‡Œ",
    "æ²™ç”°é†«é™¢": "äºå…¬è§’è¡—",
    "é›…éº—æ°ä½•å¦™é½¡é‚£æ‰“ç´ é†«é™¢": "å¤§åŸ”",
    "å¤§åŸ”é†«é™¢": "å…¨å®‰è·¯",
    "åŒ—å€é†«é™¢": "ä¸Šæ°´",
    "å±¯é–€é†«é™¢": "é’æ¾è§€è·¯",
    "åšæ„›é†«é™¢": "å…ƒæœ—",
    "å˜‰è«¾æ’’é†«é™¢": "åŠå±±",
    "æ˜å¾·åœ‹éš›é†«é™¢": "å±±é ‚",
    "é¦™æ¸¯æ¸¯å®‰é†«é™¢": "è·‘é¦¬åœ°",
    "è–ä¿ç¥¿é†«é™¢": "æ±é™¢é“",
    "é¤Šå’Œé†«é™¢": "è·‘é¦¬åœ°",
    "å¯¶è¡€é†«é™¢ï¼ˆæ˜æ„›ï¼‰": "æ·±æ°´åŸ—",
    "æ’­é“é†«é™¢": "ä¹é¾åŸ",
    "è–å¾·è‚‹æ’’é†«é™¢": "ä¹é¾åŸ",
    "é¦™æ¸¯æµ¸ä¿¡æœƒé†«é™¢": "ä¹é¾å¡˜",
    "èƒç£æ¸¯å®‰é†«é™¢": "èƒæ™¯åœ",
    "ä»å®‰é†«é™¢": "å¯Œå¥è¡—",
    "é’å±±é†«é™¢": "å±¯é–€",
    "å°æ¬–é†«é™¢": "é’æ¾è§€è·¯",
    "å¤§å£ç’°æ ¹å¾·å…¬çˆµå¤«äººå…’ç«¥é†«é™¢": "è–„æ‰¶æ—",
    "åŒ—å¤§å¶¼å±±é†«é™¢": "æ¾ä»è·¯",
    
    # æ–°å¢åœ°é»ï¼ˆ2025å¹´ä¿®è¨‚ï¼‰
    "å•Ÿå¾·éƒµè¼ªç¢¼é ­": "æ‰¿è±é“",
    "é¦™æ¸¯æ•…å®®æ–‡åŒ–åšç‰©é¤¨": "åšç‰©é¤¨é“",
    "æˆ²æ›²ä¸­å¿ƒ": "æŸ¯å£«ç”¸é“è¥¿",
    "é¦™æ¸¯éº—æ™¶é…’åº—": "å°–æ²™å’€",
    "åè¿ªæ¸¯å³¶é…’åº—": "æ‘©é “è‡º",
    "é¦™æ¸¯å¯Œéº—æ•¦æµ·æ´‹å…¬åœ’é…’åº—": "é¦™æ¸¯ä»”",
    "éº—è±ªèˆªå¤©åŸé…’åº—": "èµ¤é±²è§’",
    "è¥¿ä¹é¾æ”¿åºœåˆç½²": "æµ·åº­é“",
    "å…¥å¢ƒäº‹å‹™è™•ç¸½éƒ¨": "å°‡è»æ¾³",
    "æ©Ÿé›»å·¥ç¨‹ç½²ç¸½éƒ¨å¤§æ¨“": "å•Ÿæˆè¡—",
    "ç¾éº—è¯å»£å ´": "å°–æ²™å’€",
    "ä¸–è²¿ä¸­å¿ƒ": "å‘Šå£«æ‰“é“",
    "AIRSIDE": "å•Ÿå¾·",
    "åœæ–¹": "è»Šå…¬å»Ÿè·¯",
    "APM": "è§€å¡˜",
    "V Walk": "æ·±æ—ºé“",
    "å¯Œæ¦®èŠ±åœ’": "æµ·åº­é“",
    "æµ·å±±æ¨“": "é°‚é­šæ¶Œ",
    "å˜‰åŒ¯": "æ²å¯§è¡—",
    "æ“å¤©åŠå³¶": "æŸ¯å£«ç”¸é“è¥¿",
    "å½¢é»": "æœ—æ—¥è·¯",
    "è–æ–¹æ¿Ÿå„å¤§å­¸": "ç¿ å¶ºé‡Œ",
    
    # æ—…éŠæ™¯é»
    "ä¹é¾å¯¨åŸå…¬åœ’": "ä¹é¾åŸ",
    "æ˜‚åªçºœè»Š-æ±æ¶Œçºœè»Šç«™": "é”æ±è·¯",
    "é¦™æ¸¯æµ·æ´‹å…¬åœ’": "é»ƒç«¹å‘",
    "å¯¶è“®ç¦ªå¯º": "æ˜‚åª",
    "å‡Œéœ„é–£": "å±±é ‚é“",
    "äºæ´²åœ‹éš›åšè¦½é¤¨": "èµ¤é±²è§’",
    "å±å±±æ–‡ç‰©å¾‘": "å…ƒæœ—",
    "é¦™æ¸¯æœƒè­°å±•è¦½ä¸­å¿ƒ": "ç£ä»”",
    "é¦™æ¸¯æ–‡åŒ–åšç‰©é¤¨": "æ²™ç”°",
}

# æ‰€æœ‰å¯èƒ½çš„ä½ç½®ï¼ˆç”¨æ–¼ç”Ÿæˆå¹²æ“¾é …ï¼‰
ALL_LOCATIONS = list(set(LOCATIONS.values()))

def generate_wrong_options(correct_answer: str, count: int = 2) -> List[str]:
    """ç”ŸæˆéŒ¯èª¤é¸é …ï¼ˆå¹²æ“¾é …ï¼‰"""
    # æ’é™¤æ­£ç¢ºç­”æ¡ˆ
    wrong_pool = [loc for loc in ALL_LOCATIONS if loc != correct_answer]
    
    # éš¨æ©Ÿé¸æ“‡
    return random.sample(wrong_pool, min(count, len(wrong_pool)))

def create_location_question(place_name: str, correct_location: str, question_id: int) -> Dict:
    """å‰µå»ºåœ°é»å•é¡Œ"""
    
    # ç”Ÿæˆ 2 å€‹éŒ¯èª¤é¸é …
    wrong_options = generate_wrong_options(correct_location, 2)
    
    # çµ„åˆæ‰€æœ‰é¸é …ä¸¦æ‰“äº‚
    all_options = [correct_location] + wrong_options
    random.shuffle(all_options)
    
    # åˆ†é… A, B, C é¸é …
    options_dict = {
        "A": all_options[0],
        "B": all_options[1],
        "C": all_options[2],
    }
    
    # æ‰¾å‡ºæ­£ç¢ºç­”æ¡ˆçš„å­—æ¯
    correct_letter = [k for k, v in options_dict.items() if v == correct_location][0]
    
    question = {
        "id": f"B_{question_id:03d}",
        "question": f"{place_name}åœ¨å“ªè£¡ï¼Ÿ",
        "options": options_dict,
        "answer": correct_letter,
        "explanation": f"{place_name}ä½æ–¼{correct_location}ã€‚",
        "category": "location",
        "difficulty": "medium"
    }
    
    return question

def main():
    """ä¸»å‡½æ•¸ï¼šç”Ÿæˆå®Œæ•´é¡Œåº«"""
    
    print("ğŸš€ é–‹å§‹ç”Ÿæˆ Part B é¡Œåº«ï¼ˆåœ°æ–¹åŠè·¯ç·šè©¦é¡Œï¼‰...")
    
    questions = []
    question_id = 1
    
    # ç‚ºæ¯å€‹åœ°é»ç”Ÿæˆå•é¡Œ
    for place_name, correct_location in LOCATIONS.items():
        question = create_location_question(place_name, correct_location, question_id)
        questions.append(question)
        question_id += 1
    
    # ä¿å­˜ç‚º JSON
    output_data = {
        "part": "B",
        "title": "åœ°æ–¹åŠè·¯ç·šè©¦é¡Œ",
        "description": "æ¸¬è©¦è€ƒç”Ÿå°é¦™æ¸¯åœ°æ–¹çš„èªè­˜ï¼Œä»¥åŠè·¯ç·šè¦åŠƒçš„èƒ½åŠ›ã€‚åŒ…æ‹¬é†«é™¢ã€æ—…éŠæ™¯é»ã€é…’åº—ã€æ”¿åºœæ¨“å®‡ã€å•†æ¥­å¤§å»ˆã€è³¼ç‰©å•†å ´ã€ä½å®…æ¨“å®‡åŠå¤§å°ˆé™¢æ ¡",
        "passingScore": 80,
        "totalQuestions": len(questions),
        "lastUpdated": "2025-10-24",
        "officialSource": "é‹è¼¸ç½²åœ°æ–¹åŠè·¯ç·šè©¦é¡Œå°å†Šå­ï¼ˆ2025å¹´2æœˆä¿®è¨‚ç‰ˆï¼‰",
        "questions": questions
    }
    
    output_file = "part_b_questions.json"
    with open(output_file, 'w', encoding='utf-8') as f:
        json.dump(output_data, f, ensure_ascii=False, indent=2)
    
    print(f"\nâœ… æˆåŠŸç”Ÿæˆ {len(questions)} é“é¡Œç›®")
    print(f"ğŸ“ å·²ä¿å­˜è‡³: {output_file}")
    print(f"\nğŸ“Š é¡Œç›®çµ±è¨ˆ:")
    print(f"   - åœ°é»å•é¡Œ: {len(questions)} é¡Œ")
    print(f"   - æ¯é¡Œé¸é …: 3 å€‹ï¼ˆ1 æ­£ç¢º + 2 å¹²æ“¾ï¼‰")
    print(f"   - æ­£ç¢ºåˆ†é¡: Part B - åœ°æ–¹åŠè·¯ç·šè©¦é¡Œ")
    
    # é¡¯ç¤ºå‰ 3 é“é¡Œç›®ç¤ºä¾‹
    print(f"\nğŸ“ é¡Œç›®ç¤ºä¾‹:")
    for i, q in enumerate(questions[:3], 1):
        print(f"\n{i}. [{q['id']}] {q['question']}")
        for opt, value in q['options'].items():
            marker = "âœ“" if opt == q['answer'] else " "
            print(f"   {marker} {opt}. {value}")
        print(f"   ç­”æ¡ˆ: {q['answer']} - {q['explanation']}")

if __name__ == "__main__":
    main()
